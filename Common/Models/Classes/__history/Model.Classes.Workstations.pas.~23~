unit Model.Classes.Workstations;

interface

uses
  System.JSON,
  FireDAC.Comp.DataSet,
  Interfaces.Model.Classes.Workstations;

  procedure AssignDataSetModelClassWorkstations(const ADataSet: TFDDataSet);
  procedure AssignFileNameModelClassWorkstations(const AFileName: String);
  function CreateModelClassWorkstations: IModelClassWorkstations;
  function CreateFromJSONModelClassWorkstations(const AJSONArray: TJSONArray): IModelClassWorkstations;
  function CreateFromFileModelClassWorkstations: IModelClassWorkstations; overload;
  function CreateFromFileModelClassWorkstations(const AFileName: String): IModelClassWorkstations; overload;

implementation

uses
  System.IOUtils,
  System.SysUtils,
  Model.Classes.BaseCollection;

type
  ///<summary>Таблица - работни места</summary>
  TModelClassWorkstations = class(TModelClassBaseCollection, IModelClassWorkstations)

  {$REGION 'Class Properties'}
  private class var
    FFileName: String;
  public
    class property FileName: String read FFileName write FFileName;
  {$ENDREGION}

  {$REGION 'Private Methods'}
  private

  {$ENDREGION}

  {$REGION 'Private Fields'}
  private

  {$ENDREGION}

  {$REGION 'Private Properties Getters/Setters'}
  private

  {$ENDREGION}

  {$REGION 'Private Properties'}
  private

  {$ENDREGION}

  {$REGION 'Interfaced Properties Getters/Setters'}
  public

  {$ENDREGION}

  {$REGION 'Interfaced Properties'}
  public

  {$ENDREGION}

  {$REGION 'Interfaced Methods'}
  public
    procedure SaveToFile; override;
  {$ENDREGION}

  {$REGION 'Constructors/Destructors'}
  public

  {$ENDREGION}
  end;

{ TModelClassWorkstations }

{$REGION 'Private Methods'}

{$ENDREGION}

{$REGION 'Private Properties Getters/Setters'}

{$ENDREGION}

{$REGION 'Interfaced Properties Getters/Setters'}

{$ENDREGION}

{$REGION 'Interfaced Methods'}

procedure TModelClassWorkstations.SaveToFile;
begin
  TFile.WriteAllText(FileName, ToJSON.ToString, TEncoding.UTF8);
end;

{$ENDREGION}

{$REGION 'Constructors/Destructors'}

{$ENDREGION}

procedure AssignDataSetModelClassWorkstations(const ADataSet: TFDDataSet);
begin
  TModelClassWorkstations.AssignDataSet(ADataSet);
end;

procedure AssignFileNameModelClassWorkstations(const AFileName: String);
begin
  TModelClassWorkstations.FileName := AFileName;
end;

function CreateModelClassWorkstations: IModelClassWorkstations;
begin
  Result := TModelClassWorkstations.Create;
end;

function CreateFromJSONModelClassWorkstations(const AJSONArray: TJSONArray): IModelClassWorkstations;
begin
  Result := TModelClassWorkstations.CreateFromJSON(AJSONArray);
end;

function CreateFromFileModelClassWorkstations: IModelClassWorkstations;
begin
  Result := TModelClassWorkstations.CreateFromFile(TModelClassWorkstations.FileName);
end;

function CreateFromFileModelClassWorkstations(const AFileName: String): IModelClassWorkstations;
begin
  Result := TModelClassWorkstations.CreateFromFile(AFileName);
end;

end.
