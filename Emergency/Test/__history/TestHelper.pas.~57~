unit TestHelper;
{

  Delphi DUnit Test Case
  ----------------------
  This unit contains a skeleton test case class generated by the Test Case Wizard.
  Modify the generated code to correctly setup and call the methods from the unit
  being tested.

}

interface

uses
  TestFramework, Helper.StringMath;

type
  // Test methods for class INumber

  TestINumber = class(TTestCase)
  strict private
    FINumber: INumber;
    FINumber2: INumber;
    FINumber3: INumber;
    FINumber4: INumber;
    FINumber5: INumber;
    FINumber6: INumber;
  public
    procedure SetUp; override;
    procedure TearDown; override;
  published
    procedure TestDublicate;
    procedure TestToString;
    procedure TestAdd;
    procedure TestSubtract;
    procedure TestMultiply;
    procedure TestDivide;
    procedure TestToPrecision;
  end;
  // Test methods for class TNumber

  TestTNumber = class(TTestCase)
  strict private
    FNumber: TNumber;
  public
    procedure SetUp; override;
    procedure TearDown; override;
  published
    procedure TestDublicate;
    procedure TestToString;
    procedure TestAdd;
    procedure TestSubtract;
    procedure TestMultiply;
    procedure TestDivide;
    procedure TestToPrecision;
  end;

implementation

procedure TestINumber.SetUp;
begin
  FINumber := TNumber.CreateFromString('1.234', 2);
  FINumber2 := TNumber.CreateFromString('-1.234', 2);
  FINumber3 := TNumber.CreateFromString('1.23', 2);
  FINumber4 := TNumber.CreateFromString('-1.25', 2);
  FINumber5 := TNumber.CreateFromString('1.12345', 5);
  FINumber6 := TNumber.CreateFromString('0', 5);
end;

procedure TestINumber.TearDown;
begin
  FINumber := nil;
  FINumber2 := nil;
  FINumber3 := nil;
  FINumber4 := nil;
  FINumber5 := nil;
  FINumber6 := nil;
end;

procedure TestINumber.TestDublicate;
var
  ReturnValue: INumber;
begin
  // 1.23
  ReturnValue := FINumber.Dublicate;

  CheckEquals(123, ReturnValue.Value);
  CheckEquals(2, ReturnValue.Precision);

  ReturnValue.Value := 7;
  CheckEquals(7, ReturnValue.Value);
  CheckEquals(123, FINumber.Value);

  ReturnValue.Precision := 5;
  CheckEquals(5, ReturnValue.Precision);
  CheckEquals(2, FINumber.Precision);
end;

procedure TestINumber.TestToString;
var
  ReturnValue: string;
begin
  // Test positive number
  ReturnValue := FINumber.ToString;
  CheckEquals('1.23', ReturnValue);

  FInumber.Precision := 5;
  ReturnValue := FINumber.ToString;
  CheckEquals('0.00123', ReturnValue);

  // Test negative number
  ReturnValue := FINumber2.ToString;
  CheckEquals('-1.23', ReturnValue);

  FInumber2.ToPrecision(5);
  ReturnValue := FINumber2.ToString;
  CheckEquals('-1.23000', ReturnValue);

  FInumber2.ToPrecision(2);
  ReturnValue := FINumber2.ToString;
  CheckEquals('-1.23', ReturnValue);

  FInumber2.Precision := 5;
  ReturnValue := FINumber2.ToString;
  CheckEquals('-0.00123', ReturnValue);
end;

procedure TestINumber.TestAdd;
var
  ReturnValue: INumber;
begin
  // 1.23 + 1.23 = 2.46
  ReturnValue := FINumber.Dublicate.Add(FINumber3);

  CheckEquals(246, ReturnValue.Value);
  CheckEquals(2, ReturnValue.Precision);

  // 1.23 + 1.12345 = 2.46
  ReturnValue := FINumber.Dublicate.Add(FINumber5);

  CheckEquals(235, ReturnValue.Value);
  CheckEquals(2, ReturnValue.Precision);

  // 1.23 + (-1.25) = -0.02
  ReturnValue := FINumber.Dublicate.Add(FINumber4);

  CheckEquals(-2, ReturnValue.Value);
  CheckEquals(2, ReturnValue.Precision);

  // 1.23 + (-1.23) = 0
  ReturnValue := FINumber.Dublicate.Add(FINumber2);

  CheckEquals(0, ReturnValue.Value);
  CheckEquals(2, ReturnValue.Precision);
end;

procedure TestINumber.TestSubtract;
var
  ReturnValue: INumber;
begin
  // 1.23 - 1.23 = 0
  ReturnValue := FINumber.Dublicate.Subtract(FINumber3);

  CheckEquals(0, ReturnValue.Value);
  CheckEquals(2, ReturnValue.Precision);

  // 1.23 - (-1.25) = 2.48
  ReturnValue := FINumber.Dublicate.Subtract(FINumber4);

  CheckEquals(248, ReturnValue.Value);
  CheckEquals(2, ReturnValue.Precision);

  // 1.23 - (-1.23) = 2.46
  ReturnValue := FINumber.Dublicate.Subtract(FINumber2);

  CheckEquals(246, ReturnValue.Value);
  CheckEquals(2, ReturnValue.Precision);
end;

procedure TestINumber.TestMultiply;
var
  ReturnValue: INumber;
begin
  // 1.23 * 1.23 = 1.5129
  ReturnValue := FINumber.Dublicate.Multiply(FINumber3);

  CheckEquals(151, ReturnValue.Value);
  CheckEquals(2, ReturnValue.Precision);

  // 1.23 * -1.25 = -1.5375
  ReturnValue := FINumber.Dublicate.Multiply(FINumber4);

  CheckEquals(-154, ReturnValue.Value);
  CheckEquals(2, ReturnValue.Precision);
end;

procedure TestINumber.TestDivide;
var
  ReturnValue: INumber;
begin
  // 1.23 / 1.23 = 1
  ReturnValue := FINumber.Dublicate.Divide(FINumber3);

  CheckEquals(100, ReturnValue.Value);
  CheckEquals(2, ReturnValue.Precision);

  // 1.23 / -1.23 = -1
  ReturnValue := FINumber.Dublicate.Divide(FINumber2);

  CheckEquals(-100, ReturnValue.Value);
  CheckEquals(2, ReturnValue.Precision);

  // 1.23 / 1.12345 = 1.0948417820107703947661222128266‬
  ReturnValue := FINumber.Dublicate.Divide(FINumber5);

  CheckEquals(109, ReturnValue.Value);
  CheckEquals(2, ReturnValue.Precision);
end;

procedure TestINumber.TestToPrecision;
begin
  // 1.23
  FINumber.ToPrecision(1);
  CheckEquals(12, FINumber.Value);
  CheckEquals(1, FINumber.Precision);

  // -1.12345
  FINumber5.ToPrecision(4);
  CheckEquals(-1.1235, FINumber5.Value);
  CheckEquals(4, FINumber5.Precision);
end;





procedure TestTNumber.SetUp;
begin
  FNumber := TNumber.Create;
end;

procedure TestTNumber.TearDown;
begin
  FNumber.Free;
  FNumber := nil;
end;

procedure TestTNumber.TestDublicate;
var
  ReturnValue: INumber;
begin
  ReturnValue := FNumber.Dublicate;
  // TODO: Validate method results
end;

procedure TestTNumber.TestToString;
var
  ReturnValue: string;
begin
  ReturnValue := FNumber.ToString;
  // TODO: Validate method results
end;

procedure TestTNumber.TestAdd;
var
  ReturnValue: INumber;
  ANumber: INumber;
begin
  // TODO: Setup method call parameters
  ReturnValue := FNumber.Add(ANumber);
  // TODO: Validate method results
end;

procedure TestTNumber.TestSubtract;
var
  ReturnValue: INumber;
  ANumber: INumber;
begin
  // TODO: Setup method call parameters
  ReturnValue := FNumber.Subtract(ANumber);
  // TODO: Validate method results
end;

procedure TestTNumber.TestMultiply;
var
  ReturnValue: INumber;
  ANumber: INumber;
begin
  // TODO: Setup method call parameters
  ReturnValue := FNumber.Multiply(ANumber);
  // TODO: Validate method results
end;

procedure TestTNumber.TestDivide;
var
  ReturnValue: INumber;
  ANumber: INumber;
begin
  // TODO: Setup method call parameters
  ReturnValue := FNumber.Divide(ANumber);
  // TODO: Validate method results
end;

procedure TestTNumber.TestToPrecision;
var
  ReturnValue: INumber;
begin
  // TODO: Setup method call parameters
  ReturnValue := FNumber.ToPrecision(1);
  // TODO: Validate method results
end;

initialization
  // Register any test cases with the test runner
  RegisterTest(TestINumber.Suite);
  RegisterTest(TestTNumber.Suite);
end.

