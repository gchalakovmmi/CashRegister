unit Model.Classes.Sale.Payment;

interface

uses
  FireDAC.Comp.DataSet,
  Interfaces.Model.Classes.Sale.Payment;

  function CreateModelClassSalePayment: IModelClassSalePayment;
  function CreateFromDataSetModelClassSalePayment: IModelClassSalePayment;
  procedure AssignDataSetModelClassSalePayment(const ADataSet: TFDDataSet);

implementation

uses
  System.JSON;

//uses
//  System.SysUtils,
//  System.DateUtils;
//  Model.Generator.GIDs;

type
  TModelClassSalePayment = class(TInterfacedObject, IModelClassSalePayment)

  {$REGION 'Class Properties'}
  private class var
    FDataSet: TFDDataSet;
  public
    class property DataSet: TFDDataSet read FDataSet write FDataSet;
  {$ENDREGION}


  {$REGION 'Private Methods'}
  private

  {$ENDREGION}


  {$REGION 'Private Fields'}
  private
    FGID: String;
    FParentGID: String;
    FSaleUniqueID: String;
    FFiscalDeviceID: String;
    FUserID: String;
    FCreatedDate: String;
    FCompletedDate: String;
    FPaymentDate: String;
    FPaymentType: String;
    FPaymentBase: String;
    FPaymentVAT: String;
    FPayment: String;
  {$ENDREGION}


  {$REGION 'Private Properties Getters/Setters'}
  private

  {$ENDREGION}


  {$REGION 'Private Properties'}
  private

  {$ENDREGION}


  {$REGION 'Interfaced Properties Getters/Setters'}
  public
    function GetGID: String;
    procedure SetGID(const AValue: String);
    function GetParentGID: String;
    procedure SetParentGID(const AValue: String);
    function GetSaleUniqueID: String;
    procedure SetSaleUniqueID(const AValue: String);
    function GetFiscalDeviceID: String;
    procedure SetFiscalDeviceID(const AValue: String);
    function GetUserID: String;
    procedure SetUserID(const AValue: String);
    function GetCreatedDate: String;
    procedure SetCreatedDate(const AValue: String);
    function GetCompletedDate: String;
    procedure SetCompletedDate(const AValue: String);
    function GetPaymentDate: String;
    procedure SetPaymentDate(const AValue: String);
    function GetPaymentType: String;
    procedure SetPaymentType(const AValue: String);
    function GetPaymentBase: String;
    procedure SetPaymentBase(const AValue: String);
    function GetPaymentVAT: String;
    procedure SetPaymentVAT(const AValue: String);
    function GetPayment: String;
    procedure SetPayment(const AValue: String);
  {$ENDREGION}


  {$REGION 'Interfaced Properties'}
  public
    ///<sumarry>системен номер на продажбата, присвоен от софтуера</summary>
    property GID: String read GetGID write SetGID;
    ///<sumarry>системен номер на продажбата, присвоен от софтуера</summary>
    property ParentGID: String read GetParentGID write SetParentGID;
    ///<sumarry>уникален номер на продажба - съгласно т. 9</summary>
    property SaleUniqueID: String read GetSaleUniqueID write SetSaleUniqueID;
    ///<sumarry>номер на фискалното устройство</summary>
    property FiscalDeviceID: String read GetFiscalDeviceID write SetFiscalDeviceID;
    ///<sumarry>номер на оператор</summary>
    property UserID: String read GetUserID write SetUserID;
    ///<sumarry>дата на откриване на продажбата</summary>
    property CreatedDate: String read GetCreatedDate write SetCreatedDate;
    ///<sumarry>дата на приключване на продажбата</summary>
    property CompletedDate: String read GetCompletedDate write SetCompletedDate;
    ///<sumarry>дата на плащане</summary>
    property PaymentDate: String read GetPaymentDate write SetPaymentDate;
    ///<sumarry>вид на плащането</summary>
    property PaymentType: String read GetPaymentType write SetPaymentType;
    ///<sumarry>платена сума без ДДС - в лв.</summary>
    property PaymentBase: String read GetPaymentBase write SetPaymentBase;
    ///<sumarry>ДДС - сума - в лв.</summary>
    property PaymentVAT: String read GetPaymentVAT write SetPaymentVAT;
    ///<sumarry>платена сума с ДДС - в лв.</summary>
    property Payment: String read GetPayment write SetPayment;
  {$ENDREGION}


  {$REGION 'Interfaced Methods'}
  public
    procedure UpdateFromDataSet;
    procedure UpdateInDataSet;
    function ToJSON: TJSONObject;
  {$ENDREGION}


  {$REGION 'Constructors/Destructors'}
  public

  {$ENDREGION}
  end;

function CreateModelClassSalePayment: IModelClassSalePayment;
begin
  Result := TModelClassSalePayment.Create;
end;

function CreateFromDataSetModelClassSalePayment: IModelClassSalePayment;
begin
  Result := TModelClassSalePayment.Create;
  Result.UpdateFromDataSet;
end;

procedure AssignDataSetModelClassSalePayment(const ADataSet: TFDDataSet);
begin
  TModelClassSalePayment.DataSet := ADataSet;
end;

{ TModelClassSalePayment }

{$REGION 'Private Methods'}

{$ENDREGION}


{$REGION 'Private Properties Getters/Setters'}

{$ENDREGION}


{$REGION 'Interfaced Properties Getters/Setters'}

function TModelClassSalePayment.GetGID: String;
begin
  Result := FGID;
end;

procedure TModelClassSalePayment.SetGID(const AValue: String);
begin
  FGID := AValue;
end;

function TModelClassSalePayment.GetParentGID: String;
begin
  Result := FParentGID;
end;

procedure TModelClassSalePayment.SetParentGID(const AValue: String);
begin
  FParentGID := AValue;
end;

function TModelClassSalePayment.GetSaleUniqueID: String;
begin
  Result := FSaleUniqueID;
end;

procedure TModelClassSalePayment.SetSaleUniqueID(const AValue: String);
begin
  FSaleUniqueID := AValue;
end;

function TModelClassSalePayment.GetFiscalDeviceID: String;
begin
  Result := FFiscalDeviceID;
end;

procedure TModelClassSalePayment.SetFiscalDeviceID(const AValue: String);
begin
  FFiscalDeviceID := AValue;
end;

function TModelClassSalePayment.GetUserID: String;
begin
  Result := FUserID;
end;

procedure TModelClassSalePayment.SetUserID(const AValue: String);
begin
  FUserID := AValue;
end;

function TModelClassSalePayment.GetCreatedDate: String;
begin
  Result := FCreatedDate;
end;

procedure TModelClassSalePayment.SetCreatedDate(const AValue: String);
begin
  FCreatedDate := AValue;
end;

function TModelClassSalePayment.GetCompletedDate: String;
begin
  Result := FCompletedDate;
end;

procedure TModelClassSalePayment.SetCompletedDate(const AValue: String);
begin
  FCompletedDate := AValue;
end;

function TModelClassSalePayment.GetPaymentDate: String;
begin
  Result := FPaymentDate;
end;

procedure TModelClassSalePayment.SetPaymentDate(const AValue: String);
begin
  FPaymentDate := AValue;
end;

function TModelClassSalePayment.GetPaymentType: String;
begin
  Result := FPaymentType;
end;

procedure TModelClassSalePayment.SetPaymentType(const AValue: String);
begin
  FPaymentType := AValue;
end;

function TModelClassSalePayment.GetPaymentBase: String;
begin
  Result := FPaymentBase;
end;

procedure TModelClassSalePayment.SetPaymentBase(const AValue: String);
begin
  FPaymentBase := AValue;
end;

function TModelClassSalePayment.GetPaymentVAT: String;
begin
  Result := FPaymentVAT;
end;

procedure TModelClassSalePayment.SetPaymentVAT(const AValue: String);
begin
  FPaymentVAT := AValue;
end;

function TModelClassSalePayment.GetPayment: String;
begin
  Result := FPayment;
end;

procedure TModelClassSalePayment.SetPayment(const AValue: String);
begin
  FPayment := AValue;
end;

{$ENDREGION}


{$REGION 'Interfaced Methods'}

procedure TModelClassSalePayment.UpdateFromDataSet;
begin
  ParentGID := DataSet.FieldByName('parent_gid').Value;
  GID := DataSet.FieldByName('gid').Value;
//  CheckGID := DataSet.FieldByName('check_gid').Value;
//  Status := DataSet.FieldByName('status').Value;
//  State := TSalePaymentState(DataSet.FieldByName('state').Value);
//  ReceivedAt := DataSet.FieldByName('received_at').Value;
//  ReceivedBy := DataSet.FieldByName('received_by').Value;
//  ConfirmedAt := DataSet.FieldByName('confirmed_at').Value;
//  ConfirmedBy := DataSet.FieldByName('confirmed_by').Value;
//  PickedForPreparationAt := DataSet.FieldByName('picked_for_preparation_at').Value;
//  PickedForPreparationBy := DataSet.FieldByName('picked_for_preparation_by').Value;
//  PreparedAt := DataSet.FieldByName('prepared_at').Value;
//  PreparedBy := DataSet.FieldByName('prepared_by').Value;
//  ServedAt := DataSet.FieldByName('served_at').Value;
//  ServedBy := DataSet.FieldByName('served_by').Value;
//  CheckedAt := DataSet.FieldByName('checked_at').Value;
//  CheckedBy := DataSet.FieldByName('checked_by').Value;
//  DeliveredAt := DataSet.FieldByName('delivered_at').Value;
//  DeliveredBy := DataSet.FieldByName('delivered_by').Value;
//  CanceledAt := DataSet.FieldByName('canceled_at').Value;
//  CanceledBy := DataSet.FieldByName('canceled_by').Value;
//  ArticleGID := DataSet.FieldByName('article_gid').Value;
//  ArticleCategoryGID := DataSet.FieldByName('article_category_gid').Value;
//  ArticleCategoryName := DataSet.FieldByName('article_category_name').Value;
//  ArticleCategoryPosition := DataSet.FieldByName('article_category_position').Value;
//  ArticleCode := DataSet.FieldByName('article_code').Value;
//  ArticleName := DataSet.FieldByName('article_name').Value;
//  ArticleShortName := DataSet.FieldByName('article_short_name').Value;
//  ArticleImage := DataSet.FieldByName('article_image').Value;
//  ArticlePortion := DataSet.FieldByName('article_portion').Value;
//  ArticleMeasure := DataSet.FieldByName('article_measure').Value;
//  ArticlePrice := DataSet.FieldByName('article_price').Value;
//  ArticleGroup := DataSet.FieldByName('article_group').Value;
//  ArticleSection := DataSet.FieldByName('article_section').Value;
//  ArticlePackageGID := DataSet.FieldByName('article_package_gid').Value;
//  ArticlePackageQuantity := DataSet.FieldByName('article_package_quantity').Value;
//  ArticleQuantity := DataSet.FieldByName('article_quantity').Value;
//  ArticleTotal := DataSet.FieldByName('article_total').Value;
//  ArticleModificators := DataSet.FieldByName('article_modificators').Value;
//  ArticleModificatorsPrice := DataSet.FieldByName('article_modificators_price').Value;
//  ArticleModificatorsTotal := DataSet.FieldByName('article_modificators_total').Value;
//  Price := DataSet.FieldByName('price').Value;
//  Total := DataSet.FieldByName('total').Value;
//  GuestGID := DataSet.FieldByName('guest_gid').Value;
//  GuestPosition := DataSet.FieldByName('guest_position').Value;
//  GuestName := DataSet.FieldByName('guest_name').Value;
end;

procedure TModelClassSalePayment.UpdateInDataSet;
begin
  if DataSet.Locate('GID', GID) then begin
    DataSet.Edit;
  end else begin
    DataSet.Append;
  end;

  DataSet.FieldByName('parent_gid').Value := ParentGID;
  DataSet.FieldByName('gid').Value := GID;
//  DataSet.FieldByName('check_gid').Value := CheckGID;
//  DataSet.FieldByName('status').Value := Status;
//  DataSet.FieldByName('state').Value := Ord(State);
//  DataSet.FieldByName('received_at').Value := ReceivedAt;
//  DataSet.FieldByName('received_by').Value := ReceivedBy;
//  DataSet.FieldByName('confirmed_at').Value := ConfirmedAt;
//  DataSet.FieldByName('confirmed_by').Value := ConfirmedBy;
//  DataSet.FieldByName('picked_for_preparation_at').Value := PickedForPreparationAt;
//  DataSet.FieldByName('picked_for_preparation_by').Value := PickedForPreparationBy;
//  DataSet.FieldByName('prepared_at').Value := PreparedAt;
//  DataSet.FieldByName('prepared_by').Value := PreparedBy;
//  DataSet.FieldByName('served_at').Value := ServedAt;
//  DataSet.FieldByName('served_by').Value := ServedBy;
//  DataSet.FieldByName('checked_at').Value := CheckedAt;
//  DataSet.FieldByName('checked_by').Value := CheckedBy;
//  DataSet.FieldByName('delivered_at').Value := DeliveredAt;
//  DataSet.FieldByName('delivered_by').Value := DeliveredBy;
//  DataSet.FieldByName('canceled_at').Value := CanceledAt;
//  DataSet.FieldByName('canceled_by').Value := CanceledBy;
//  DataSet.FieldByName('article_gid').Value := ArticleGID;
//  DataSet.FieldByName('article_category_gid').Value := ArticleCategoryGID;
//  DataSet.FieldByName('article_category_name').Value := ArticleCategoryName;
//  DataSet.FieldByName('article_category_position').Value := ArticleCategoryPosition;
//  DataSet.FieldByName('article_code').Value := ArticleCode;
//  DataSet.FieldByName('article_name').Value := ArticleName;
//  DataSet.FieldByName('article_short_name').Value := ArticleShortName;
//  DataSet.FieldByName('article_image').Value := ArticleImage;
//  DataSet.FieldByName('article_portion').Value := ArticlePortion;
//  DataSet.FieldByName('article_measure').Value := ArticleMeasure;
//  DataSet.FieldByName('article_price').Value := ArticlePrice;
//  DataSet.FieldByName('article_group').Value := ArticleGroup;
//  DataSet.FieldByName('article_section').Value := ArticleSection;
//  DataSet.FieldByName('article_package_gid').Value := ArticlePackageGID;
//  DataSet.FieldByName('article_package_quantity').Value := ArticlePackageQuantity;
//  DataSet.FieldByName('article_quantity').Value := ArticleQuantity;
//  DataSet.FieldByName('article_total').Value := ArticleTotal;
//  DataSet.FieldByName('article_modificators').Value := ArticleModificators;
//  DataSet.FieldByName('article_modificators_price').Value := ArticleModificatorsPrice;
//  DataSet.FieldByName('article_modificators_total').Value := ArticleModificatorsTotal;
//  DataSet.FieldByName('price').Value := Price;
//  DataSet.FieldByName('total').Value := Total;
//  DataSet.FieldByName('guest_gid').Value := GuestGID;
//  DataSet.FieldByName('guest_position').Value := GuestPosition;
//  DataSet.FieldByName('guest_name').Value := GuestName;

  DataSet.Post;
end;

function TModelClassSalePayment.ToJSON: TJSONObject;
begin
  Result := TJSONObject.Create;
  Result.AddPair('GID', GID);
  Result.AddPair('ParentGID', ParentGID);
  Result.AddPair('SaleUniqueID', SaleUniqueID);
  Result.AddPair('FiscalDeviceID', FiscalDeviceID);
  Result.AddPair('UserID', UserID);
  Result.AddPair('CreatedDate', CreatedDate);
  Result.AddPair('CompletedDate', CompletedDate);
  Result.AddPair('PaymentDate', PaymentDate);
  Result.AddPair('PaymentType', PaymentType);
  Result.AddPair('PaymentBase', PaymentBase);
  Result.AddPair('PaymentVAT', PaymentVAT);
  Result.AddPair('Payment', Payment);
end;

{$ENDREGION}


{$REGION 'Constructors/Destructors'}

{$ENDREGION}

end.

